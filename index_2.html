<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>?ChatAI</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<style>
body {
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;

  /* Background photo */
  background: url("images (1).jpeg") no-repeat center center fixed;
  background-size: cover;
  color: white; /* âœ… All default text is white */
}

/* Glass Effect Base */
.glass {
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: none; 
  -webkit-backdrop-filter: none;
  border: 1px solid rgba(255, 255, 255, 0.25);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
  border-radius: 12px;
}

/* Sidebar Styling */
.sidebar {
  background-color: black;
  width: 240px;
  transition: all 0.3s ease-in-out;
  border-right: 2px solid rgba(200, 200, 200, 0.2);
  position: relative;
  color: white;
}
.sidebar.glass { border-radius: 0 12px 12px 0; }

.sidebar.collapsed { width: 70px; }
.sidebar.collapsed .label,
.sidebar.collapsed .logo-text { display: none; }

.sidebar-item {
  cursor: pointer;
  padding: 10px;
  border-radius: 8px;
  margin-bottom: 8px;
  color: white;
  transition: background-color 0.3s, transform 0.2s;
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 1rem;
}
.sidebar-item i { font-size: 1.3rem; color: white; }
.sidebar-item:hover { background-color: rgba(255, 255, 255, 0.15); transform: translateX(5px); }
.active-item { background-color: rgba(255, 255, 255, 0.2); border-left: 3px solid white; font-weight: bold; color: white; }

.toggle-btn { cursor: pointer; color: white; }
.profile { margin-top: auto; border-top: 1px solid rgba(255, 255, 255, 0.2); padding-top: 10px; color: white; }

/* Content Area */
.content { color: white; border-radius: 12px; }
.content.glass { padding: 20px; }
.content h2 { color: white; }

/* âœ… Search bar */
.search-bar {
  max-width: 500px;
  background-color: rgba(255, 255, 255, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 8px;
}
.search-bar .form-control::placeholder {
  color: rgba(255, 255, 255, 0.7);
}
.search-bar .form-control {
  color: white;
  background: transparent;
  border: none;
}
.search-bar .input-group-text {
  background: transparent;
  border: none;
  color: white;
}

/* Navigation toggle button */
.nav-toggle { color: white; cursor: pointer; }

/* ðŸ”¥ Custom Logout Buttons */
.custom-btn {
  padding: 10px 20px;
  font-size: 1rem;
  border-radius: 30px;
  border: none;
  transition: all 0.3s ease;
  font-weight: bold;
}

.custom-btn.cancel {
  background: rgba(255, 255, 255, 0.2);
  color: white;
}

.custom-btn.cancel:hover {
  background: rgba(255, 255, 255, 0.4);
  transform: scale(1.05);
}

.custom-btn.logout {
  background: #dc3545; /* Bootstrap danger red */
  color: white;
  box-shadow: 0 0 10px rgba(220, 53, 69, 0.6);
}

.custom-btn.logout:hover {
  background: #bb2d3b;
  box-shadow: 0 0 15px rgba(220, 53, 69, 0.8);
  transform: scale(1.05);
}
</style>

<div class="d-flex vh-100">
  <!-- Sidebar -->
  <div id="sidebar" class="sidebar glass d-flex flex-column justify-content-between p-3 text-white">
    <div>
      <div class="d-flex align-items-center justify-content-between mb-4 toggle-btn" onclick="toggleSidebar()">
        <h1 class="fs-5 fw-bold m-0 logo-text">ChatAI</h1>
        <span class="fs-3 nav-toggle">&#9776;</span>
      </div>

      <!-- Sidebar Menu with Icons -->
      <ul class="list-unstyled" id="menu">
        <li class="sidebar-item active-item" onclick="setActive(this)">
          <i class="bi bi-house-door-fill"></i> <span class="label">Home</span>
        </li>
        <li class="sidebar-item" onclick="setActive(this)">
          <i class="bi bi-chat-dots-fill"></i> <span class="label">Chats</span>
        </li>
        
        <!-- Chat History with Submenu -->
        <li class="sidebar-item" data-bs-toggle="collapse" data-bs-target="#chatHistoryMenu">
          <i class="bi bi-journal-text"></i> <span class="label">Chat History</span>
        </li>
        <ul class="collapse list-unstyled ps-4" id="chatHistoryMenu">
          <li class="sidebar-item small">Math Homework Help</li>
          <li class="sidebar-item small">Daily Journal</li>
          <li class="sidebar-item small">Project Ideas</li>
          <li class="sidebar-item small">Random Q&A</li>
          <li class="sidebar-item small">Travel Plans</li>
        </ul>

        <li class="sidebar-item" onclick="setActive(this)">
          <i class="bi bi-book-half"></i> <span class="label">Library</span>
        </li>
        <li class="sidebar-item" onclick="setActive(this)">
          <i class="bi bi-gear-fill"></i> <span class="label">Settings</span>
        </li>
      </ul>
    </div>

    <!-- Profile Dropdown -->
    <div class="dropdown profile">
      <div class="sidebar-item d-flex align-items-center gap-2" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="bi bi-person-circle"></i> <span class="label">Profile</span>
      </div>
      <ul class="dropdown-menu dropdown-menu-dark glass">
        <li><a class="dropdown-item" href="#">Account Settings</a></li>
        <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#logoutModal">Logout</a></li>
      </ul>
    </div>
  </div>

  <!-- Content -->
  <div class="flex-grow-1 content glass p-4" id="content">
    <!-- âœ… Search bar with icon -->
    <div class="d-flex justify-content-center mb-4">
      <div class="input-group search-bar">
        <span class="input-group-text">
          <i class="bi bi-search"></i>
        </span>
        <input
          type="text"
          id="searchInput"
          class="form-control"
          placeholder="Search ChatAi..."
          onkeyup="searchChats(event)"
        />
      </div>
    </div>

    <h2 class="fw-bold">Home</h2>
    <p class="fs-5">Welcome to ChatAI</p>
  </div>
</div>

<!-- âœ… Redesigned Logout Confirmation Modal -->
<div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content glass text-white" style="border-radius: 20px; overflow: hidden;">
      <div class="modal-header border-0 text-center">
        <h5 class="modal-title w-100 fw-bold" id="logoutModalLabel" style="font-size: 1.5rem; letter-spacing: 1px;">
          ðŸšª Confirm Logout
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center fs-5">
        Are you sure you want to logout?
      </div>
      <div class="modal-footer border-0 justify-content-center">
        <button type="button" class="btn custom-btn cancel" data-bs-dismiss="modal">No, Stay</button>
        <button type="button" class="btn custom-btn logout">Yes, Logout</button>
      </div>
    </div>
  </div>
</div>

<script>
// âœ… Collapse sidebar & close all submenus
function toggleSidebar() {
  const sidebar = document.getElementById("sidebar");
  const chatHistoryMenu = document.getElementById("chatHistoryMenu");
  const bsCollapse = bootstrap.Collapse.getOrCreateInstance(chatHistoryMenu);

  sidebar.classList.toggle("collapsed");

  // If sidebar is collapsed, close all submenus
  if (sidebar.classList.contains("collapsed")) {
    bsCollapse.hide();
  }
}

// Set active menu item + update content
function setActive(element) {
  document.querySelectorAll(".sidebar-item").forEach((item) => {
    item.classList.remove("active-item");
  });
  element.classList.add("active-item");

  const label = element.innerText.trim();

  if (label === "Chats") {
    document.getElementById("content").innerHTML = `
      <div class="chat-wrapper d-flex flex-column glass" style="height: 100%; position: relative;">
        <div id="chatMessages" class="flex-grow-1 overflow-auto p-3 mb-5" style="background: rgba(255,255,255,0.1); border-radius: 8px;">
          <div class="ai-message p-2 mb-2 rounded" style="background: rgba(255,255,255,0.2); max-width: 70%;">ðŸ‘‹ Hello! How can I help you today?</div>
        </div>
        <div class="chat-input d-flex p-2 glass" style="position: absolute; bottom: 0; left: 0; width: 100%; border-top: 1px solid rgba(255,255,255,0.3);">
          <input type="text" id="chatInput" class="form-control me-2" placeholder="Type your message..." />
          <button class="btn btn-primary" onclick="sendMessage()">Send</button>
        </div>
      </div>
    `;
  } else {
    document.getElementById("content").innerHTML = `
      <div class="d-flex justify-content-center mb-4">
        <div class="input-group search-bar">
          <span class="input-group-text">
            <i class="bi bi-search"></i>
          </span>
          <input type="text" id="searchInput" class="form-control" placeholder="Search ChatAi..." onkeyup="searchChats(event)" />
        </div>
      </div>
      <h2 class="fw-bold">${label}</h2>
      <p class="fs-5">You are in the ${label} section.</p>
    `;
  }
}

// Send message function
function sendMessage() {
  const input = document.getElementById("chatInput");
  const messages = document.getElementById("chatMessages");
  const userText = input.value.trim();

  if (userText !== "") {
    messages.innerHTML += `<div class="user-message text-end p-2 mb-2 rounded" style="background: rgba(13,110,253,0.7); color: white; max-width: 70%; margin-left: auto;">${userText}</div>`;

    setTimeout(() => {
      messages.innerHTML += `<div class="ai-message p-2 mb-2 rounded" style="background: rgba(255,255,255,0.2); max-width: 70%;">ðŸ¤– I received: "${userText}"</div>`;
      messages.scrollTop = messages.scrollHeight;
    }, 600);

    input.value = "";
    messages.scrollTop = messages.scrollHeight;
  }
}

// ðŸ”Ž Search Chat History
function searchChats(event) {
  const query = event.target.value.toLowerCase().trim();
  const chatItems = document.querySelectorAll("#chatHistoryMenu .sidebar-item");

  chatItems.forEach((item) => {
    const text = item.innerText.toLowerCase();
    if (text.includes(query)) {
      item.style.display = "block";
      item.innerHTML = highlightMatch(item.innerText, query);
    } else {
      item.style.display = "none";
    }
  });
}

// âœ¨ Highlight matches
function highlightMatch(text, query) {
  if (!query) return text;
  const regex = new RegExp(`(${query})`, "gi");
  return text.replace(regex, `<span style="background: yellow; color: black; border-radius: 3px; padding: 1px 3px;">$1</span>`);
}

// âœ… Auto-expand sidebar when clicking Chat History if collapsed
document.querySelector('[data-bs-target="#chatHistoryMenu"]').addEventListener("click", function (e) {
  const sidebar = document.getElementById("sidebar");
  
  if (sidebar.classList.contains("collapsed")) {
    sidebar.classList.remove("collapsed");

    // Open submenu smoothly after expanding
    setTimeout(() => {
      let bsCollapse = bootstrap.Collapse.getOrCreateInstance(document.getElementById("chatHistoryMenu"));
      bsCollapse.show();
    }, 200);

    e.preventDefault(); // stop default toggle on first click
  }
});

// âœ… Close Chat History when clicking other sidebar items
document.querySelectorAll(".sidebar-item").forEach((item) => {
  item.addEventListener("click", function () {
    const chatHistoryMenu = document.getElementById("chatHistoryMenu");
    const bsCollapse = bootstrap.Collapse.getOrCreateInstance(chatHistoryMenu);

    // Skip if the click was on Chat History itself or submenu items
    if (this.getAttribute("data-bs-target") === "#chatHistoryMenu" || this.parentElement.id === "chatHistoryMenu") return;

    // Close Chat History submenu if open
    bsCollapse.hide();
  });
});

// âœ… Open Chat History item in content area
document.querySelectorAll("#chatHistoryMenu .sidebar-item").forEach((chatItem) => {
  chatItem.addEventListener("click", function () {
    const chatTitle = this.innerText.trim();

    // Set active state
    document.querySelectorAll("#chatHistoryMenu .sidebar-item").forEach(item => item.classList.remove("active-item"));
    this.classList.add("active-item");

    // Load the selected chat
    document.getElementById("content").innerHTML = `
      <div class="chat-wrapper d-flex flex-column glass" style="height: 100%; position: relative;">
        <div id="chatMessages" class="flex-grow-1 overflow-auto p-3 mb-5" style="background: rgba(255,255,255,0.1); border-radius: 8px;">
          <div class="ai-message p-2 mb-2 rounded" style="background: rgba(255,255,255,0.2); max-width: 70%;">ðŸ‘‹ Welcome back to "${chatTitle}"!</div>
        </div>
        <div class="chat-input d-flex p-2 glass" style="position: absolute; bottom: 0; left: 0; width: 100%; border-top: 1px solid rgba(255,255,255,0.3);">
          <input type="text" id="chatInput" class="form-control me-2" placeholder="Type your message..." />
          <button class="btn btn-primary" onclick="sendMessage()">Send</button>
        </div>
      </div>
    `;
  });
});
</script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
